C51 COMPILER V7.50   22TRANSIFIER                                                          05/08/2012 19:38:27 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE 22TRANSIFIER
OBJECT MODULE PLACED IN 22transifier.OBJ
COMPILER INVOKED BY: E:\keil\C51\BIN\C51.EXE 22transifier.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include<REG52.H>
   2          #include<IMSutil.h>
   3          
   4          volatile unsigned long c;
   5          
   6          //use the timer1 work at 19200 baud and mode is 1 no parity 
   7          void initUart( void );
   8          
   9          
  10          unsigned char xdata xArrayAt3000[0xFF + 1] _at_ 0x3000;
  11          
  12          int main( void )
  13          {
  14   1      
  15   1              initUart();
  16   1      
  17   1      
  18   1              delay_uc( 100 );//let other slave get ready
  19   1      
  20   1              //initial the data _at_ 0x3000
  21   1              for( c=0; c<=0xFF; c++ )
  22   1              {
  23   2                      xArrayAt3000[c] = c;
  24   2              }
  25   1      
  26   1              c = 0;
  27   1      
  28   1              ES = 1;
  29   1              EA = 1;
  30   1      
  31   1              TI = 1;  //software trigger the transfier finish
  32   1                      
  33   1              while( 1 );
  34   1      
  35   1              return 0;
  36   1      }
  37          
  38          //use timer1 @mode1 run @19200 baud
  39          void initUart( void )
  40          {
  41   1              TMOD = 0x20;
  42   1              PCON = 0x80;
  43   1              TH1 = TL1 = 0xFD;
  44   1              SM0 = 0;
  45   1              SM1 = 1;
  46   1              SM2 = 0;
  47   1              REN = 1;
  48   1      
  49   1              TR1 = 1;   //timer1 start 
  50   1      }
  51          
  52          //the transfier routine
  53          void uartInterrupt( void ) interrupt 4
  54          {
  55   1              if( TI )  //it's a transfer interrupt
C51 COMPILER V7.50   22TRANSIFIER                                                          05/08/2012 19:38:27 PAGE 2   

  56   1              {
  57   2                      TI = 0;
  58   2      
  59   2                      if( c <= 0xFF )
  60   2                      {
  61   3                              SBUF = xArrayAt3000[c];
  62   3                              c++;
  63   3                      }
  64   2      
  65   2              }
  66   1              else      //it's a recever interrupt
  67   1              {
  68   2                      RI = 0;
  69   2              }
  70   1      
  71   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    247    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
