C51 COMPILER V7.50   21MAIN                                                                05/08/2012 18:21:04 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE 21MAIN
OBJECT MODULE PLACED IN 21main.OBJ
COMPILER INVOKED BY: E:\keil\C51\BIN\C51.EXE 21main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include<REG52.H>
   2          #include"IMSutil.h"
   3          
   4          
   5          //use the timer1 work at 19200 baud and mode is 2 with even parity 
   6          void initUart( void );
   7          
   8          void sendByte( unsigned char b );
   9          
  10          unsigned char xdata xArrayAt3000[0xFF + 1] _at_ 0x3000;
  11          
  12          int main( void )
  13          {
  14   1              unsigned long c;
  15   1      
  16   1              initUart();
  17   1      
  18   1              delay_uc( 100 );//let other slave get ready
  19   1      
  20   1              //initial the data _at_ 0x3000
  21   1      
  22   1              for( c=0; c<=0xFF; c++ )
  23   1              {
  24   2                      xArrayAt3000[c] = c;
  25   2              }
  26   1      
  27   1              //use the query to send data with even parity eagaged
  28   1              for( c=0 ; c<= 0xFF; c++ )
  29   1              {
  30   2                      sendByte( xArrayAt3000[c] );
  31   2                      delay_uc( 100 );
  32   2              }
  33   1      
  34   1              while( 1 );
  35   1      
  36   1              return 0;
  37   1      }
  38          
  39          //use timer1 @mode2
  40          void initUart( void )
  41          {
  42   1              TMOD = 0x20;
  43   1              PCON = 0x80;
  44   1              TH1 = TL1 = 0xFD;
  45   1              SM0 = 1;
  46   1              SM1 = 1;
  47   1              SM2 = 0;
  48   1              REN = 1;
  49   1      
  50   1              TR1 = 1;
  51   1      
  52   1      }
  53          
  54          //send a byte with TB using the even parity
  55          void sendByte( unsigned char b )
C51 COMPILER V7.50   21MAIN                                                                05/08/2012 18:21:04 PAGE 2   

  56          {
  57   1              unsigned char sc;
  58   1              unsigned char cnt;
  59   1              unsigned char bs;
  60   1      
  61   1              TI = 0;
  62   1      
  63   1              sc = 0;
  64   1              bs = b;
  65   1              for( cnt=0 ; cnt<8 ; cnt++ )
  66   1              {
  67   2                      sc += ( bs>>cnt ) & 0x01;
  68   2              }
  69   1      
  70   1              if( ( sc % 2) == 0 )
  71   1              {
  72   2                      TB8 = 0;
  73   2              }else
  74   1              {
  75   2                      TB8 = 1;
  76   2              }
  77   1      
  78   1              SBUF = b;
  79   1              while( !TI );
  80   1              TI = 0;
  81   1      }
  82          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    217    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
