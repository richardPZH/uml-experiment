C51 COMPILER V7.50   MAIN                                                                  05/01/2012 16:15:13 PAGE 1   


C51 COMPILER V7.50, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: E:\keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include<REG52.H>
   2          
   3          #define COUNTER0_C 3
   4          #define COUNTER1_C 6
   5          #define EightMax 256
   6          
   7          #define LED_PORT1 P0
   8          #define LED_PORT2 P2
   9          
  10          volatile unsigned char tc0;
  11          volatile unsigned char tc1;
  12          
  13          void time( unsigned int ucMs );
  14          
  15          int main( void )
  16          {
  17   1              LED_PORT1 = 0xFF;
  18   1              LED_PORT2 = 0xFF;
  19   1      
  20   1              P1 = 0x00; 
  21   1      
  22   1              TMOD = 0x66;                                             //counter1 counter2 use extern t1 t0 count and automataclly reload
  23   1              TH1 = TL1 = EightMax - COUNTER1_C;   //TH1 TL1 with initial value to go
  24   1              TH0 = TL0 =     EightMax - COUNTER0_C;   //TH0 TL0 with initial value
  25   1      
  26   1              //interrupt control
  27   1              ET0 = 1;       //enable timer0 interrupt
  28   1              ET1 = 1;       //enable timer1 interrupt
  29   1      
  30   1              EA = 1;        //enable global interrupt
  31   1      
  32   1              TR0 = 1;       //both start counting
  33   1              TR1 = 1;
  34   1      
  35   1              tc0 = tc1 = 0;
  36   1              while( 1 )
  37   1              {
  38   2              }
  39   1      
  40   1              return 0;
  41   1      }
  42          
  43          //timer/counter0 interrupt function
  44          void counter0( void ) interrupt 1
  45          {
  46   1              unsigned char c;
  47   1              EA = 0;
  48   1      
  49   1              tc0++;
  50   1              P1 = ( tc0 << 4 ) | ( tc1 & 0x0F );
  51   1      
  52   1              for( c=0 ; c<3 ; c++ )
  53   1              {
  54   2                      LED_PORT1 = 0xF0;
  55   2                      time( 150 );
C51 COMPILER V7.50   MAIN                                                                  05/01/2012 16:15:13 PAGE 2   

  56   2                      LED_PORT1 = 0xFF;
  57   2                      time( 150 );
  58   2              }
  59   1      
  60   1              EA = 1;
  61   1      }
  62          
  63          //timer/counter1 interrupt function
  64          void counter1( void ) interrupt 3
  65          {
  66   1              unsigned char c;
  67   1              EA = 0;
  68   1      
  69   1              tc1++;
  70   1              P1 = ( tc0 << 4 ) | ( tc1 & 0x0F );
  71   1      
  72   1              for( c=0 ; c<6 ; c++ )
  73   1              {
  74   2                      LED_PORT2 = 0xF0;
  75   2                      time( 150 );
  76   2                      LED_PORT2 = 0xFF;
  77   2                      time( 150 );
  78   2              }
  79   1      
  80   1              EA = 1; 
  81   1      }
  82          
  83          void time( unsigned int ucMs )
  84          {
  85   1      #define DELAYTIMES 239
  86   1          unsigned char ucCounter;
  87   1      
  88   1          while( ucMs != 0 )
  89   1          {
  90   2              for( ucCounter = 0 ; ucCounter < DELAYTIMES; ucCounter++ ){}
  91   2              ucMs--;
  92   2          }
  93   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    260    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
